import{e as pe,m as K,x as me}from"./useFocusRing-ubySK4Mk.js";import{$ as G}from"./useNumberFormatter-BKAMG5zQ.js";import{r as H}from"./index-Dq4ZvVuH.js";import{f as q}from"./utils-LaqegW2K.js";import{$ as ve}from"./context-DWzCBS5d.js";import{$ as ge}from"./useControlledState-BJxFPo-I.js";function $e(){return typeof window.ResizeObserver<"u"}function V(t){const{ref:e,box:l,onResize:n}=t;let o=pe(n);H.useEffect(()=>{let r=e==null?void 0:e.current;if(r)if($e()){const c=new window.ResizeObserver(f=>{f.length&&o()});return c.observe(r,{box:l}),()=>{r&&c.unobserve(r)}}else return window.addEventListener("resize",o,!1),()=>{window.removeEventListener("resize",o,!1)}},[e,l])}const S={top:"top",bottom:"top",left:"left",right:"left"},W={top:"bottom",bottom:"top",left:"right",right:"left"},he={top:"left",left:"top"},J={top:"height",left:"width"},ie={width:"totalWidth",height:"totalHeight"},U={};let be=()=>typeof document<"u"?window.visualViewport:null;function ee(t,e){let l=0,n=0,o=0,r=0,c=0,f=0,u={};var s;let p=((s=e==null?void 0:e.scale)!==null&&s!==void 0?s:1)>1;if(t.tagName==="BODY"||t.tagName==="HTML"){let $=document.documentElement;o=$.clientWidth,r=$.clientHeight;var h;l=(h=e==null?void 0:e.width)!==null&&h!==void 0?h:o;var g;n=(g=e==null?void 0:e.height)!==null&&g!==void 0?g:r,u.top=$.scrollTop||t.scrollTop,u.left=$.scrollLeft||t.scrollLeft,e&&(c=e.offsetTop,f=e.offsetLeft)}else({width:l,height:n,top:c,left:f}=Z(t,!1)),u.top=t.scrollTop,u.left=t.scrollLeft,o=l,r=n;if(me()&&(t.tagName==="BODY"||t.tagName==="HTML")&&p){u.top=0,u.left=0;var m;c=(m=e==null?void 0:e.pageTop)!==null&&m!==void 0?m:0;var a;f=(a=e==null?void 0:e.pageLeft)!==null&&a!==void 0?a:0}return{width:l,height:n,totalWidth:o,totalHeight:r,scroll:u,top:c,left:f}}function xe(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function te(t,e,l,n,o,r,c){var f;let u=(f=o.scroll[t])!==null&&f!==void 0?f:0,s=n[J[t]],p=c[t]+n.scroll[S[t]]+r,h=c[t]+n.scroll[S[t]]+s-r,g=e-u+n.scroll[S[t]]+c[t]-n[S[t]],m=e-u+l+n.scroll[S[t]]+c[t]-n[S[t]];return g<p?p-g:m>h?Math.max(h-m,p-g):0}function Ee(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function oe(t){if(U[t])return U[t];let[e,l]=t.split(" "),n=S[e]||"right",o=he[n];S[l]||(l="center");let r=J[n],c=J[o];return U[t]={placement:e,crossPlacement:l,axis:n,crossAxis:o,size:r,crossSize:c},U[t]}function B(t,e,l,n,o,r,c,f,u,s,p){let{placement:h,crossPlacement:g,axis:m,crossAxis:a,size:$,crossSize:x}=n,P={};var i;P[a]=(i=t[a])!==null&&i!==void 0?i:0;var L,d,b,v;g==="center"?P[a]+=(((L=t[x])!==null&&L!==void 0?L:0)-((d=l[x])!==null&&d!==void 0?d:0))/2:g!==a&&(P[a]+=((b=t[x])!==null&&b!==void 0?b:0)-((v=l[x])!==null&&v!==void 0?v:0)),P[a]+=r;const T=t[a]-l[x]+u+s,C=t[a]+t[x]-u-s;if(P[a]=G(P[a],T,C),h===m){let y=f?p[$]:p[ie[$]];P[W[m]]=Math.floor(y-t[m]+o)}else P[m]=Math.floor(t[m]+t[$]+o);return P}function Pe(t,e,l,n,o,r,c,f,u,s,p){var h,g;let m=(t.top!=null?t.top:u[ie.height]-((h=t.bottom)!==null&&h!==void 0?h:0)-c)-((g=u.scroll.top)!==null&&g!==void 0?g:0),a=s?l.top:0;var $,x,P;let i={top:Math.max(e.top+a,(($=p==null?void 0:p.offsetTop)!==null&&$!==void 0?$:e.top)+a),bottom:Math.min(e.top+e.height+a,((x=p==null?void 0:p.offsetTop)!==null&&x!==void 0?x:0)+((P=p==null?void 0:p.height)!==null&&P!==void 0?P:0))};var L,d,b,v;return f!=="top"?Math.max(0,i.bottom-m-(((L=o.top)!==null&&L!==void 0?L:0)+((d=o.bottom)!==null&&d!==void 0?d:0)+r)):Math.max(0,m+c-i.top-(((b=o.top)!==null&&b!==void 0?b:0)+((v=o.bottom)!==null&&v!==void 0?v:0)+r))}function le(t,e,l,n,o,r,c,f){let{placement:u,axis:s,size:p}=r;var h,g;if(u===s)return Math.max(0,l[s]-((h=c.scroll[s])!==null&&h!==void 0?h:0)-(t[s]+(f?e[s]:0))-((g=n[s])!==null&&g!==void 0?g:0)-n[W[s]]-o);var m,a;return Math.max(0,t[p]+t[s]+(f?e[s]:0)-l[s]-l[p]+((m=c.scroll[s])!==null&&m!==void 0?m:0)-((a=n[s])!==null&&a!==void 0?a:0)-n[W[s]]-o)}function Ce(t,e,l,n,o,r,c,f,u,s,p,h,g,m,a,$,x,P){let i=oe(t),{size:L,crossAxis:d,crossSize:b,placement:v,crossPlacement:T}=i,C=B(e,f,l,i,p,h,s,g,a,$,u),y=p,F=le(f,s,e,o,r+p,i,u,x);if(c&&l[L]>F){let j=oe(`${W[v]} ${T}`),ue=B(e,f,l,j,p,h,s,g,a,$,u);le(f,s,e,o,r+p,j,u,x)>F&&(i=j,C=ue,y=p)}let A="bottom";i.axis==="top"?i.placement==="top"?A="top":i.placement==="bottom"&&(A="bottom"):i.crossAxis==="top"&&(i.crossPlacement==="top"?A="bottom":i.crossPlacement==="bottom"&&(A="top"));let w=te(d,C[d],l[b],f,u,r,s);C[d]+=w;let R=Pe(C,f,s,g,o,r,l.height,A,u,x,P);m&&m<R&&(R=m),l.height=Math.min(l.height,R),C=B(e,f,l,i,y,h,s,g,a,$,u),w=te(d,C[d],l[b],f,u,r,s),C[d]+=w;let z={},I=e[d]-C[d]-o[S[d]],M=I+.5*e[b];const X=a/2+$;var N,k,_,O;const Y=S[d]==="left"?((N=o.left)!==null&&N!==void 0?N:0)+((k=o.right)!==null&&k!==void 0?k:0):((_=o.top)!==null&&_!==void 0?_:0)+((O=o.bottom)!==null&&O!==void 0?O:0),ae=l[b]-Y-a/2-$,ce=e[d]+a/2-(C[d]+o[S[d]]),se=e[d]+e[b]-a/2-(C[d]+o[S[d]]),fe=G(M,ce,se);z[d]=G(fe,X,ae),{placement:v,crossPlacement:T}=i,a?I=z[d]:T==="right"?I+=e[b]:T==="center"&&(I+=e[b]/2);let D=v==="left"||v==="top"?l[L]:0,de={x:v==="top"||v==="bottom"?I:D,y:v==="left"||v==="right"?I:D};return{position:C,maxHeight:R,arrowOffsetLeft:z.left,arrowOffsetTop:z.top,placement:v,triggerAnchorPoint:de}}function Te(t){let{placement:e,targetNode:l,overlayNode:n,scrollNode:o,padding:r,shouldFlip:c,boundaryElement:f,offset:u,crossOffset:s,maxHeight:p,arrowSize:h=0,arrowBoundaryOffset:g=0}=t,m=be(),a=n instanceof HTMLElement?we(n):document.documentElement,$=a===document.documentElement;const x=window.getComputedStyle(a).position;let P=!!x&&x!=="static",i=$?Z(l,!1):re(l,a,!1);if(!$){let{marginTop:z,marginLeft:I}=window.getComputedStyle(l);i.top+=parseInt(z,10)||0,i.left+=parseInt(I,10)||0}let L=Z(n,!0),d=Ee(n);var b,v;L.width+=((b=d.left)!==null&&b!==void 0?b:0)+((v=d.right)!==null&&v!==void 0?v:0);var T,C;L.height+=((T=d.top)!==null&&T!==void 0?T:0)+((C=d.bottom)!==null&&C!==void 0?C:0);let y=xe(o),F=ee(f,m),A=ee(a,m),w=re(f,a,!1),R=K(f,a);return Ce(e,i,L,y,d,r,c,F,A,w,u,s,P,p,h,g,R,m)}function Q(t,e){let{top:l,left:n,width:o,height:r}=t.getBoundingClientRect();return e&&t instanceof t.ownerDocument.defaultView.HTMLElement&&(o=t.offsetWidth,r=t.offsetHeight),{top:l,left:n,width:o,height:r}}function Z(t,e){let{top:l,left:n,width:o,height:r}=Q(t,e),{scrollTop:c,scrollLeft:f,clientTop:u,clientLeft:s}=document.documentElement;return{top:l+c-u,left:n+f-s,width:o,height:r}}function re(t,e,l){let n=window.getComputedStyle(t),o;if(n.position==="fixed")o=Q(t,l);else{o=Z(t,l);let r=Z(e,l),c=window.getComputedStyle(e);r.top+=(parseInt(c.borderTopWidth,10)||0)-e.scrollTop,r.left+=(parseInt(c.borderLeftWidth,10)||0)-e.scrollLeft,o.top-=r.top,o.left-=r.left}return o.top-=parseInt(n.marginTop,10)||0,o.left-=parseInt(n.marginLeft,10)||0,o}function we(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!ne(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!ne(e);)e=e.parentElement;return e||document.documentElement}function ne(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const Le=new WeakMap;function _e(t){let{triggerRef:e,isOpen:l,onClose:n}=t;H.useEffect(()=>{if(!l||n===null)return;let o=r=>{let c=r.target;if(!e.current||c instanceof Node&&!K(c,e.current)||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement)return;let f=n||Le.get(e.current);f&&f()};return window.addEventListener("scroll",o,!0),()=>{window.removeEventListener("scroll",o,!0)}},[l,n,e])}let E=typeof document<"u"?window.visualViewport:null;function Fe(t){let{direction:e}=ve(),{arrowSize:l,targetRef:n,overlayRef:o,arrowRef:r,scrollRef:c=o,placement:f="bottom",containerPadding:u=12,shouldFlip:s=!0,boundaryElement:p=typeof document<"u"?document.body:null,offset:h=0,crossOffset:g=0,shouldUpdatePosition:m=!0,isOpen:a=!0,onClose:$,maxHeight:x,arrowBoundaryOffset:P=0}=t,[i,L]=H.useState(null),d=[m,f,o.current,n.current,r==null?void 0:r.current,c.current,u,s,p,h,g,a,e,x,P,l],b=H.useRef(E==null?void 0:E.scale);H.useEffect(()=>{a&&(b.current=E==null?void 0:E.scale)},[a]);let v=H.useCallback(()=>{if(m===!1||!a||!o.current||!n.current||!p||(E==null?void 0:E.scale)!==b.current)return;let w=null;if(c.current&&K(c.current,document.activeElement)){var R;let _=(R=document.activeElement)===null||R===void 0?void 0:R.getBoundingClientRect(),O=c.current.getBoundingClientRect();var z;if(w={type:"top",offset:((z=_==null?void 0:_.top)!==null&&z!==void 0?z:0)-O.top},w.offset>O.height/2){w.type="bottom";var I;w.offset=((I=_==null?void 0:_.bottom)!==null&&I!==void 0?I:0)-O.bottom}}let M=o.current;if(!x&&o.current){var X;M.style.top="0px",M.style.bottom="";var N;M.style.maxHeight=((N=(X=window.visualViewport)===null||X===void 0?void 0:X.height)!==null&&N!==void 0?N:window.innerHeight)+"px"}let k=Te({placement:He(f,e),overlayNode:o.current,targetNode:n.current,scrollNode:c.current||o.current,padding:u,shouldFlip:s,boundaryElement:p,offset:h,crossOffset:g,maxHeight:x,arrowSize:l??(r!=null&&r.current?Q(r.current,!0).width:0),arrowBoundaryOffset:P});if(k.position){if(M.style.top="",M.style.bottom="",M.style.left="",M.style.right="",Object.keys(k.position).forEach(_=>M.style[_]=k.position[_]+"px"),M.style.maxHeight=k.maxHeight!=null?k.maxHeight+"px":"",w&&document.activeElement&&c.current){let _=document.activeElement.getBoundingClientRect(),O=c.current.getBoundingClientRect(),Y=_[w.type]-O[w.type];c.current.scrollTop+=Y-w.offset}L(k)}},d);q(v,d),Re(v),V({ref:o,onResize:v}),V({ref:n,onResize:v});let T=H.useRef(!1);q(()=>{let w,R=()=>{T.current=!0,clearTimeout(w),w=setTimeout(()=>{T.current=!1},500),v()},z=()=>{T.current&&R()};return E==null||E.addEventListener("resize",R),E==null||E.addEventListener("scroll",z),()=>{E==null||E.removeEventListener("resize",R),E==null||E.removeEventListener("scroll",z)}},[v]);let C=H.useCallback(()=>{T.current||$==null||$()},[$,T]);_e({triggerRef:n,isOpen:a,onClose:$&&C});var y,F,A;return{overlayProps:{style:{position:i?"absolute":"fixed",top:i?void 0:0,left:i?void 0:0,zIndex:1e5,...i==null?void 0:i.position,maxHeight:(y=i==null?void 0:i.maxHeight)!==null&&y!==void 0?y:"100vh"}},placement:(F=i==null?void 0:i.placement)!==null&&F!==void 0?F:null,triggerAnchorPoint:(A=i==null?void 0:i.triggerAnchorPoint)!==null&&A!==void 0?A:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:i==null?void 0:i.arrowOffsetLeft,top:i==null?void 0:i.arrowOffsetTop}},updatePosition:v}}function Re(t){q(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function He(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}const ze=H.createContext({});function Ne(){var t;return(t=H.useContext(ze))!==null&&t!==void 0?t:{}}function Xe(t){let[e,l]=ge(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const n=H.useCallback(()=>{l(!0)},[l]),o=H.useCallback(()=>{l(!1)},[l]),r=H.useCallback(()=>{l(!e)},[l,e]);return{isOpen:e,setOpen:l,open:n,close:o,toggle:r}}const Ze=H.createContext({placement:"bottom"});export{Xe as $,Ne as a,Fe as b,Ze as c,V as d,Le as e};
