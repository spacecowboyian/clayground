import{f as ie,a as L,b as G,$ as S,g as j,o as re,d as J,m as Q,c as O,e as F,k as X,p as de,h as ne}from"./utils-LaqegW2K.js";import{$ as se,a as ce,b as Y,c as ue,d as H,g as fe,f as $e}from"./Collection-B0KnfY9F.js";import{r as s,R as u}from"./index-Dq4ZvVuH.js";import{c as ve,d as be,e as ge,a as pe,b as xe,f as me,g as he}from"./Separator-3hPFwPTm.js";import{b as Pe}from"./RSPContexts-Dr342rEE.js";import{$ as De}from"./SelectionIndicator-CoNWZYQ1.js";import{a as ye,b as Ee}from"./SharedElementTransition-BV-eLIt9.js";import{a as Me}from"./Text-VdVr9Ew-.js";import{e as Ce,d as we,w as Se,x as Be,i as Z,y as q,g as Fe,z as Le,j as Ie}from"./useFocusRing-ubySK4Mk.js";import{a as Ve,$ as Oe,b as ke}from"./useListState-_TFEiqPD.js";import{e as Te}from"./SelectionManager-DSMsdBE7.js";import{$ as Ue}from"./Label-ZdcYzoi0.js";import{$ as Ae}from"./context-DWzCBS5d.js";function Ke(t,e){let{collection:a,onLoadMore:o,scrollOffset:i=1}=t,r=s.useRef(null),l=Ce(d=>{for(let c of d)c.isIntersecting&&o&&o()});ie(()=>(e.current&&(r.current=new IntersectionObserver(l,{root:ve(e==null?void 0:e.current),rootMargin:`0px ${100*i}% ${100*i}% ${100*i}%`}),r.current.observe(e.current)),()=>{r.current&&r.current.disconnect()}),[a,e,i])}const R=new WeakMap;function Ne(t){return typeof t=="string"?t.replace(/\s*/g,""):""+t}function ze(t,e){let a=R.get(t);if(!a)throw new Error("Unknown list");return`${a.id}-option-${Ne(e)}`}function _e(t,e,a){let o=L(t,{labelable:!0}),i=t.selectionBehavior||"toggle",r=t.linkBehavior||(i==="replace"?"action":"override");i==="toggle"&&r==="action"&&(r="override");let{listProps:l}=be({...t,ref:a,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:r}),{focusWithinProps:d}=we({onFocusWithin:t.onFocus,onBlurWithin:t.onBlur,onFocusWithinChange:t.onFocusChange}),c=G(t.id);R.set(e,{id:c,shouldUseVirtualFocus:t.shouldUseVirtualFocus,shouldSelectOnPressUp:t.shouldSelectOnPressUp,shouldFocusOnHover:t.shouldFocusOnHover,isVirtualized:t.isVirtualized,onAction:t.onAction,linkBehavior:r,UNSTABLE_itemBehavior:t.UNSTABLE_itemBehavior});let{labelProps:f,fieldProps:v}=Ue({...t,id:c,labelElementType:"span"});return{labelProps:f,listBoxProps:S(o,d,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...S(v,l)})}}function He(t,e,a){var o,i;let{key:r}=t,l=R.get(e);var d;let c=(d=t.isDisabled)!==null&&d!==void 0?d:e.selectionManager.isDisabled(r);var f;let v=(f=t.isSelected)!==null&&f!==void 0?f:e.selectionManager.isSelected(r);var n;let $=(n=t.shouldSelectOnPressUp)!==null&&n!==void 0?n:l==null?void 0:l.shouldSelectOnPressUp;var x;let p=(x=t.shouldFocusOnHover)!==null&&x!==void 0?x:l==null?void 0:l.shouldFocusOnHover;var P;let D=(P=t.shouldUseVirtualFocus)!==null&&P!==void 0?P:l==null?void 0:l.shouldUseVirtualFocus;var g;let E=(g=t.isVirtualized)!==null&&g!==void 0?g:l==null?void 0:l.isVirtualized,M=j(),C=j(),m={role:"option","aria-disabled":c||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?v:void 0};Se()&&Be()||(m["aria-label"]=t["aria-label"],m["aria-labelledby"]=M,m["aria-describedby"]=C);let b=e.collection.getItem(r);if(E){let y=Number(b==null?void 0:b.index);m["aria-posinset"]=Number.isNaN(y)?void 0:y+1,m["aria-setsize"]=ge(e.collection)}let h=l!=null&&l.onAction?()=>{var y;return l==null||(y=l.onAction)===null||y===void 0?void 0:y.call(l,r)}:void 0,w=ze(e,r),{itemProps:I,isPressed:T,isFocused:V,hasAction:z,allowsSelection:U}=Te({selectionManager:e.selectionManager,key:r,ref:a,shouldSelectOnPressUp:$,allowsDifferentPressOrigin:$&&p,isVirtualized:E,shouldUseVirtualFocus:D,isDisabled:c,onAction:h||!(b==null||(o=b.props)===null||o===void 0)&&o.onAction?re(b==null||(i=b.props)===null||i===void 0?void 0:i.onAction,h):void 0,linkBehavior:l==null?void 0:l.linkBehavior,UNSTABLE_itemBehavior:l==null?void 0:l.UNSTABLE_itemBehavior,id:w}),{hoverProps:A}=Z({isDisabled:c||!p,onHoverStart(){q()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(r))}}),B=L(b==null?void 0:b.props);delete B.id;let K=Fe(b==null?void 0:b.props);return{optionProps:{...m,...S(B,I,A,K),id:w},labelProps:{id:M},descriptionProps:{id:C},isFocused:V,isFocusVisible:V&&e.selectionManager.isFocused&&q(),isSelected:v,isDisabled:c,isPressed:T,allowsSelection:U,hasAction:z}}function Re(t){let{heading:e,"aria-label":a}=t,o=G();return{itemProps:{role:"presentation"},headingProps:e?{id:o,role:"presentation",onMouseDown:i=>{i.preventDefault()}}:{},groupProps:{role:"group","aria-label":a,"aria-labelledby":e?o:void 0}}}const N=s.createContext({}),ee=s.createContext(null),We=s.forwardRef(function(e,a){let{render:o}=s.useContext(ee);return u.createElement(u.Fragment,null,o(e,a))});function te(t,e){var a;let o=t==null?void 0:t.renderDropIndicator,i=t==null||(a=t.isVirtualDragging)===null||a===void 0?void 0:a.call(t),r=s.useCallback(l=>{if(i||e!=null&&e.isDropTarget(l))return o?o(l):u.createElement(We,{target:l})},[e==null?void 0:e.target,i,o]);return t!=null&&t.useDropIndicator?r:void 0}function je(t,e,a){var o,i;let r=t.focusedKey,l=null;if(!(e==null||(o=e.isVirtualDragging)===null||o===void 0)&&o.call(e)&&(a==null||(i=a.target)===null||i===void 0?void 0:i.type)==="item"&&(l=a.target.key,a.target.dropPosition==="after")){let n=a.collection.getKeyAfter(l),$=null;if(n!=null){var d,c;let x=(c=(d=a.collection.getItem(l))===null||d===void 0?void 0:d.level)!==null&&c!==void 0?c:0;for(;n;){let p=a.collection.getItem(n);if(!p)break;if(p.type!=="item"){n=a.collection.getKeyAfter(n);continue}var f;if(((f=p.level)!==null&&f!==void 0?f:0)<=x)break;$=n,n=a.collection.getKeyAfter(n)}}var v;l=(v=n??$)!==null&&v!==void 0?v:l}return s.useMemo(()=>new Set([r,l].filter(n=>n!=null)),[r,l])}const oe=s.createContext(null),k=s.createContext(null),ut=s.forwardRef(function(e,a){[e,a]=J(e,a,oe);let o=s.useContext(k);return o?u.createElement(ae,{state:o,props:e,listBoxRef:a}):u.createElement(se,{content:u.createElement(ce,e)},i=>u.createElement(qe,{props:e,listBoxRef:a,collection:i}))});function qe({props:t,listBoxRef:e,collection:a}){t={...t,collection:a,children:null,items:null};let{layoutDelegate:o}=s.useContext(H),i=Oe({...t,layoutDelegate:o});return u.createElement(ae,{state:i,props:t,listBoxRef:e})}function ae({state:t,props:e,listBoxRef:a}){[e,a]=J(e,a,Pe);let{dragAndDropHooks:o,layout:i="stack",orientation:r="vertical",filter:l}=e,d=Ve(t,l),{collection:c,selectionManager:f}=d,v=!!(o!=null&&o.useDraggableCollectionState),n=!!(o!=null&&o.useDroppableCollectionState),{direction:$}=Ae(),{disabledBehavior:x,disabledKeys:p}=f,P=pe({usage:"search",sensitivity:"base"}),{isVirtualized:D,layoutDelegate:g,dropTargetDelegate:E,CollectionRoot:M}=s.useContext(H),C=s.useMemo(()=>e.keyboardDelegate||new xe({collection:c,collator:P,ref:a,disabledKeys:p,disabledBehavior:x,layout:i,orientation:r,direction:$,layoutDelegate:g}),[c,P,a,x,p,r,$,e.keyboardDelegate,i,g]),{listBoxProps:m}=_e({...e,shouldSelectOnPressUp:v||e.shouldSelectOnPressUp,keyboardDelegate:C,isVirtualized:D},d,a);s.useRef(v),s.useRef(n),s.useEffect(()=>{},[v,n]);let b,h,w,I=!1,T=null,V=s.useRef(null);if(v&&o){b=o.useDraggableCollectionState({collection:c,selectionManager:f,preview:o.renderDragPreview?V:void 0}),o.useDraggableCollection({},b,a);let _=o.DragPreview;T=o.renderDragPreview?u.createElement(_,{ref:V},o.renderDragPreview):null}if(n&&o){h=o.useDroppableCollectionState({collection:c,selectionManager:f});let _=o.dropTargetDelegate||E||new o.ListDropTargetDelegate(c,a,{orientation:r,layout:i,direction:$});w=o.useDroppableCollection({keyboardDelegate:C,dropTargetDelegate:_},h,a),I=h.isDropTarget({type:"root"})}let{focusProps:z,isFocused:U,isFocusVisible:A}=Ie(),B=d.collection.size===0,K={isDropTarget:I,isEmpty:B,isFocused:U,isFocusVisible:A,layout:e.layout||"stack",state:d},y=O({...e,children:void 0,defaultClassName:"react-aria-ListBox",values:K}),W=null;B&&e.renderEmptyState&&(W=u.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(K)));let le=L(e,{global:!0});return u.createElement(ye,null,u.createElement(F.div,{...S(le,y,m,z,w==null?void 0:w.collectionProps),ref:a,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":I||void 0,"data-empty":B||void 0,"data-focused":U||void 0,"data-focus-visible":A||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},u.createElement(X,{values:[[oe,e],[k,d],[N,{dragAndDropHooks:o,dragState:b,dropState:h}],[me,{elementType:"div"}],[ee,{render:Je}],[fe,{name:"ListBoxSection",render:Ge}]]},u.createElement(Ee,null,u.createElement(M,{collection:c,scrollRef:a,persistedKeys:je(f,o,h),renderDropIndicator:te(o,h)}))),W,T))}function Ge(t,e,a,o="react-aria-ListBoxSection"){let i=s.useContext(k),{dragAndDropHooks:r,dropState:l}=s.useContext(N),{CollectionBranch:d}=s.useContext(H),[c,f]=ne();var v;let{headingProps:n,groupProps:$}=Re({heading:f,"aria-label":(v=t["aria-label"])!==null&&v!==void 0?v:void 0}),x=O({...t,id:void 0,children:void 0,defaultClassName:o,values:void 0}),p=L(t,{global:!0});return delete p.id,u.createElement(F.section,{...S(p,x,$),ref:e},u.createElement(he.Provider,{value:{...n,ref:c}},u.createElement(d,{collection:i.collection,parent:a,renderDropIndicator:te(r,l)})))}const ft=Y(ue,function(e,a,o){let i=Q(a),r=s.useContext(k),{dragAndDropHooks:l,dragState:d,dropState:c}=s.useContext(N),{optionProps:f,labelProps:v,descriptionProps:n,...$}=He({key:o.key,"aria-label":e==null?void 0:e["aria-label"]},r,i),{hoverProps:x,isHovered:p}=Z({isDisabled:!$.allowsSelection&&!$.hasAction,onHoverStart:o.props.onHoverStart,onHoverChange:o.props.onHoverChange,onHoverEnd:o.props.onHoverEnd}),{focusProps:P}=Le(e),D=null;d&&l&&(D=l.useDraggableItem({key:o.key,hasAction:$.hasAction},d));let g=null;c&&l&&(g=l.useDroppableItem({target:{type:"item",key:o.key,dropPosition:"on"}},c,i));let E=d&&d.isDragging(o.key),M=O({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...$,isHovered:p,selectionMode:r.selectionManager.selectionMode,selectionBehavior:r.selectionManager.selectionBehavior,allowsDragging:!!d,isDragging:E,isDropTarget:g==null?void 0:g.isDropTarget}});s.useEffect(()=>{o.textValue},[o.textValue]);let C=e.href?F.a:F.div,m=L(e,{global:!0});return delete m.id,delete m.onClick,e.href&&f.tabIndex==null&&(f.tabIndex=-1),u.createElement(C,{...S(m,M,f,x,P,D==null?void 0:D.dragProps,g==null?void 0:g.dropProps),ref:i,"data-allows-dragging":!!d||void 0,"data-selected":$.isSelected||void 0,"data-disabled":$.isDisabled||void 0,"data-hovered":p||void 0,"data-focused":$.isFocused||void 0,"data-focus-visible":$.isFocusVisible||void 0,"data-pressed":$.isPressed||void 0,"data-dragging":E||void 0,"data-drop-target":(g==null?void 0:g.isDropTarget)||void 0,"data-selection-mode":r.selectionManager.selectionMode==="none"?void 0:r.selectionManager.selectionMode},u.createElement(X,{values:[[Me,{slots:{[de]:v,label:v,description:n}}],[De,{isSelected:$.isSelected}]]},M.children))});function Je(t,e){e=Q(e);let{dragAndDropHooks:a,dropState:o}=s.useContext(N),{dropIndicatorProps:i,isHidden:r,isDropTarget:l}=a.useDropIndicator(t,o,e);return r?null:u.createElement(Xe,{...t,dropIndicatorProps:i,isDropTarget:l,ref:e})}function Qe(t,e){let{dropIndicatorProps:a,isDropTarget:o,...i}=t,r=O({...i,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:o}});return u.createElement(F.div,{...a,...r,role:"option",ref:e,"data-drop-target":o||void 0})}const Xe=s.forwardRef(Qe);Y($e,function(e,a,o){let i=s.useContext(k),{isLoading:r,onLoadMore:l,scrollOffset:d,...c}=e,f=s.useRef(null),v=s.useMemo(()=>({onLoadMore:l,collection:i==null?void 0:i.collection,sentinelRef:f,scrollOffset:d}),[l,d,i==null?void 0:i.collection]);Ke(v,f);let n=O({...c,id:void 0,children:o.rendered,defaultClassName:"react-aria-ListBoxLoadingIndicator",values:void 0}),$={tabIndex:-1};return u.createElement(u.Fragment,null,u.createElement("div",{style:{position:"relative",width:0,height:0},inert:ke(!0)},u.createElement("div",{"data-testid":"loadMoreSentinel",ref:f,style:{position:"absolute",height:1,width:1}})),r&&n.children&&u.createElement(F.div,{...S(L(e,{global:!0}),$),...n,role:"option",ref:a},n.children))});export{k as $,N as a,ee as b,te as c,je as d,Ke as e,R as f,ze as g,oe as h,ut as i,ft as j};
