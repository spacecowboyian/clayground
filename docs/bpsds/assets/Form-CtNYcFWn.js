import{c as E,b as P,E as T,r as U,v as j}from"./Hidden-CJaOgpXL.js";import{r as n,R as D}from"./index-Dx_1l3Sb.js";import{a as N}from"./Text-CtOaLkQJ.js";function Z(a,e,t){let i=E(()=>{t&&t(e)});n.useEffect(()=>{var o;let l=a==null||(o=a.current)===null||o===void 0?void 0:o.form;return l==null||l.addEventListener("reset",i),()=>{l==null||l.removeEventListener("reset",i)}},[a])}const M={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},R={...M,customError:!0,valid:!1},m={isInvalid:!1,validationDetails:M,validationErrors:[]},Q=n.createContext({}),C="__formValidationState"+Date.now();function ee(a){if(a[C]){let{realtimeValidation:e,displayValidation:t,updateValidation:i,resetValidation:o,commitValidation:l}=a[C];return{realtimeValidation:e,displayValidation:t,updateValidation:i,resetValidation:o,commitValidation:l}}return _(a)}function _(a){let{isInvalid:e,validationState:t,name:i,value:o,builtinValidation:l,validate:u,validationBehavior:v="aria"}=a;t&&(e||(e=t==="invalid"));let f=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:R}:null,d=n.useMemo(()=>{if(!u||o==null)return null;let s=k(u,o);return L(s)},[u,o]);l!=null&&l.validationDetails.valid&&(l=void 0);let r=n.useContext(Q),c=n.useMemo(()=>i?Array.isArray(i)?i.flatMap(s=>x(r[s])):x(r[i]):[],[r,i]),[$,F]=n.useState(r),[S,p]=n.useState(!1);r!==$&&(F(r),p(!1));let V=n.useMemo(()=>L(S?[]:c),[S,c]),w=n.useRef(m),[g,y]=n.useState(m),b=n.useRef(m),O=()=>{if(!B)return;h(!1);let s=d||l||w.current;I(s,b.current)||(b.current=s,y(s))},[B,h]=n.useState(!1);return n.useEffect(O),{realtimeValidation:f||V||d||l||m,displayValidation:v==="native"?f||V||g:f||V||d||l||g,updateValidation(s){v==="aria"&&!I(g,s)?y(s):w.current=s},resetValidation(){let s=m;I(s,b.current)||(b.current=s,y(s)),v==="native"&&h(!1),p(!0)},commitValidation(){v==="native"&&h(!0),p(!0)}}}function x(a){return a?Array.isArray(a)?a:[a]:[]}function k(a,e){if(typeof a=="function"){let t=a(e);if(t&&typeof t!="boolean")return x(t)}return[]}function L(a){return a.length?{isInvalid:!0,validationErrors:a,validationDetails:R}:null}function I(a,e){return a===e?!0:!!a&&!!e&&a.isInvalid===e.isInvalid&&a.validationErrors.length===e.validationErrors.length&&a.validationErrors.every((t,i)=>t===e.validationErrors[i])&&Object.entries(a.validationDetails).every(([t,i])=>e.validationDetails[t]===i)}function te(...a){let e=new Set,t=!1,i={...M};for(let u of a){var o,l;for(let v of u.validationErrors)e.add(v);t||(t=u.isInvalid);for(let v in i)(o=i)[l=v]||(o[l]=u.validationDetails[v])}return i.valid=!t,{isInvalid:t,validationErrors:[...e],validationDetails:i}}function ae(a,e,t){let{validationBehavior:i,focus:o}=a;P(()=>{if(i==="native"&&(t!=null&&t.current)&&!t.current.disabled){let d=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";t.current.setCustomValidity(d),t.current.hasAttribute("title")||(t.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(Y(t.current))}});let l=n.useRef(!1),u=E(()=>{l.current||e.resetValidation()}),v=E(d=>{var r;e.displayValidation.isInvalid||e.commitValidation();let c=t==null||(r=t.current)===null||r===void 0?void 0:r.form;if(!d.defaultPrevented&&t&&c&&z(c)===t.current){var $;o?o():($=t.current)===null||$===void 0||$.focus(),T("keyboard")}d.preventDefault()}),f=E(()=>{e.commitValidation()});n.useEffect(()=>{let d=t==null?void 0:t.current;if(!d)return;let r=d.form,c=r==null?void 0:r.reset;return r&&(r.reset=()=>{l.current=!window.event||window.event.type==="message"&&window.event.target instanceof MessagePort,c==null||c.call(r),l.current=!1}),d.addEventListener("invalid",v),d.addEventListener("change",f),r==null||r.addEventListener("reset",u),()=>{d.removeEventListener("invalid",v),d.removeEventListener("change",f),r==null||r.removeEventListener("reset",u),r&&(r.reset=c)}},[t,i])}function q(a){let e=a.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function Y(a){return{isInvalid:!a.validity.valid,validationDetails:q(a),validationErrors:a.validationMessage?[a.validationMessage]:[]}}function z(a){for(let e=0;e<a.elements.length;e++){let t=a.elements[e];if(!t.validity.valid)return t}return null}const A=n.createContext(null),ie=n.forwardRef(function(e,t){let i=n.useContext(A);return i!=null&&i.isInvalid?D.createElement(G,{...e,ref:t}):null}),G=n.forwardRef((a,e)=>{let t=n.useContext(A),i=U(a,{global:!0}),o=j({...a,defaultClassName:"react-aria-FieldError",defaultChildren:t.validationErrors.length===0?void 0:t.validationErrors.join(" "),values:t});return o.children==null?null:D.createElement(N,{slot:"errorMessage",...i,...o,ref:e})}),re=n.createContext(null);export{ee as $,Z as a,ae as b,re as c,A as d,C as e,m as f,te as g,ie as h};
